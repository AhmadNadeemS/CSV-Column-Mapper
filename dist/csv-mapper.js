/*! For license information please see csv-mapper.js.LICENSE.txt */
!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.CsvMapper=n():e.CsvMapper=n()}(this,()=>(()=>{"use strict";var e={56:(e,n,t)=>{e.exports=function(e){var n=t.nc;n&&e.setAttribute("nonce",n)}},72:e=>{var n=[];function t(e){for(var t=-1,r=0;r<n.length;r++)if(n[r].identifier===e){t=r;break}return t}function r(e,r){for(var a={},i=[],s=0;s<e.length;s++){var c=e[s],l=r.base?c[0]+r.base:c[0],d=a[l]||0,p="".concat(l," ").concat(d);a[l]=d+1;var u=t(p),v={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==u)n[u].references++,n[u].updater(v);else{var f=o(v,r);r.byIndex=s,n.splice(s,0,{identifier:p,updater:f,references:1})}i.push(p)}return i}function o(e,n){var t=n.domAPI(n);return t.update(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap&&n.supports===e.supports&&n.layer===e.layer)return;t.update(e=n)}else t.remove()}}e.exports=function(e,o){var a=r(e=e||[],o=o||{});return function(e){e=e||[];for(var i=0;i<a.length;i++){var s=t(a[i]);n[s].references--}for(var c=r(e,o),l=0;l<a.length;l++){var d=t(a[l]);0===n[d].references&&(n[d].updater(),n.splice(d,1))}a=c}}},113:e=>{e.exports=function(e,n){if(n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}},314:e=>{e.exports=function(e){var n=[];return n.toString=function(){return this.map(function(n){var t="",r=void 0!==n[5];return n[4]&&(t+="@supports (".concat(n[4],") {")),n[2]&&(t+="@media ".concat(n[2]," {")),r&&(t+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),t+=e(n),r&&(t+="}"),n[2]&&(t+="}"),n[4]&&(t+="}"),t}).join("")},n.i=function(e,t,r,o,a){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(r)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(i[c]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);r&&i[d[0]]||(void 0!==a&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=a),t&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=t):d[2]=t),o&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=o):d[4]="".concat(o)),n.push(d))}},n}},365:(e,n,t)=>{t.d(n,{A:()=>u});var r=t(601),o=t.n(r),a=t(314),i=t.n(a),s=t(417),c=t.n(s),l=new URL(t(912),t.b),d=i()(o()),p=c()(l);d.push([e.id,`/* Theme Variables - Change these to customize the entire color scheme */\n:root {\n    --csv-primary: #6366f1;        /* Indigo 500 - Main theme color */\n    --csv-primary-hover: #4f46e5;  /* Indigo 600 - Hover state */\n    --csv-primary-light: #eef2ff;  /* Indigo 50 - Light backgrounds */\n    --csv-primary-dark: #4338ca;   /* Indigo 700 - Dark text on light bg */\n    --csv-bg-main: #f9fafb;        /* Gray 50 - Main background */\n    --csv-bg-card: #ffffff;        /* White - Card backgrounds */\n    --csv-text-primary: #111827;   /* Gray 900 - Primary text */\n    --csv-text-secondary: #6b7280; /* Gray 500 - Secondary text */\n    --csv-border: #e5e7eb;         /* Gray 200 - Borders */\n    --csv-border-dark: #d1d5db;    /* Gray 300 - Darker borders */\n}\n\n/* Main Container & Modal */\n.csv-mapper-overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(17, 24, 39, 0.6);\n    backdrop-filter: blur(4px);\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    z-index: 9999;\n    font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;\n    -webkit-font-smoothing: antialiased;\n}\n\n.csv-mapper-modal {\n    background: white;\n    width: 900px;\n    max-width: calc(100% - 3rem);\n    height: calc(100vh - 3rem);\n    max-height: calc(100vh - 3rem);\n    border-radius: 16px; /* Softer corners */\n    display: flex;\n    flex-direction: column;\n    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); /* Soft shadow */\n    overflow: hidden; /* Ensure children don't bleed */\n}\n\n.csv-mapper-header {\n    padding: 20px 32px;\n    border-bottom: 1px solid #f3f4f6;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    background: white;\n}\n\n.csv-mapper-header h2 {\n    margin: 0;\n    font-size: 20px;\n    font-weight: 600;\n    color: #111827; /* Gray 900 */\n    letter-spacing: -0.025em;\n}\n\n.csv-mapper-close {\n    cursor: pointer;\n    font-size: 24px;\n    color: #9ca3af; /* Gray 400 */\n    line-height: 1;\n    transition: color 0.2s;\n}\n\n.csv-mapper-close:hover {\n    color: #4b5563; /* Gray 600 */\n}\n\n.csv-mapper-body {\n    flex: 1;\n    overflow-y: auto;\n    overflow-x: hidden;\n    padding: 32px;\n    background: #f9fafb; /* Gray 50 */\n    position: relative;\n}\n\n.csv-mapper-footer {\n    padding: 20px 32px;\n    border-top: 1px solid #f3f4f6;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    background: white;\n    position: relative;\n    z-index: 10001;\n}\n\n.csv-footer-right {\n    display: flex;\n    gap: 12px;\n}\n\n.csv-error-banner {\n    background: #fef2f2; /* Red 50 */\n    border-top: 1px solid #fee2e2; /* Red 200 */\n    padding: 12px 24px;\n    color: #b91c1c; /* Red 700 */\n    font-size: 14px;\n    text-align: center;\n    font-weight: 500;\n}\n\n/* Buttons */\n.csv-btn {\n    padding: 10px 20px;\n    border-radius: 8px;\n    font-size: 14px;\n    font-weight: 500;\n    cursor: pointer;\n    border: 1px solid transparent;\n    transition: all 0.2s ease;\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.csv-btn-primary {\n    background: var(--csv-primary) !important;\n    color: white;\n    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n}\n\n.csv-btn-primary:hover {\n    background: var(--csv-primary-hover);\n}\n\n.csv-btn-secondary {\n    background: var(--csv-bg-card);\n    border: 1px solid var(--csv-border);\n    color: #374151;\n    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n}\n\n.csv-btn-secondary:hover {\n    background: var(--csv-bg-main);\n    border-color: var(--csv-border-dark);\n    color: var(--csv-text-primary);\n}\n\n.csv-btn-danger {\n    background: white;\n    border: 1px solid #fecaca; /* Red 200 */\n    color: #ef4444; /* Red 500 */\n}\n\n.csv-btn-danger:hover {\n    background: #fef2f2; /* Red 50 */\n    border-color: #fca5a5; /* Red 300 */\n    color: #dc2626; /* Red 600 */\n}\n\n/* Step 1: Upload */\n.csv-upload-area {\n    background: white;\n    border: 2px dashed #e5e7eb; /* Gray 200 */\n    border-radius: 12px;\n    padding: 80px 40px;\n    text-align: center;\n    transition: all 0.2s;\n    cursor: pointer;\n}\n\n.csv-upload-area:hover {\n    border-color: var(--csv-primary);\n}\n\n.csv-upload-area.dragover {\n    border-color: var(--csv-primary);\n}\n\n.csv-upload-text {\n    font-size: 18px;\n    font-weight: 600;\n    color: #111827;\n    margin-bottom: 8px;\n}\n\n.csv-upload-subtext {\n    font-size: 14px;\n    color: #6b7280; /* Gray 500 */\n}\n\n.csv-paste-link {\n    display: block;\n    text-align: center;\n    margin-top: 24px;\n    color: var(--csv-primary);\n    cursor: pointer;\n    text-decoration: none;\n    font-weight: 500;\n    font-size: 14px;\n}\n\n.csv-paste-link:hover {\n    color: var(--csv-primary-hover);\n    text-decoration: underline;\n}\n\n/* Step 2: Header Selection */\n.csv-preview-table-container {\n    background: white;\n    border: 1px solid #e5e7eb;\n    border-radius: 12px;\n    overflow: hidden; /* For border radius */\n    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);\n}\n\n.csv-table {\n    width: 100%;\n    border-collapse: separate;\n    border-spacing: 0;\n    font-size: 14px;\n}\n\n.csv-table th, .csv-table td {\n    padding: 14px 16px;\n    border-bottom: 1px solid #e5e7eb;\n    text-align: left;\n    color: #374151;\n}\n\n.csv-table th {\n    background: #f9fafb; /* Gray 50 */\n    font-weight: 600;\n    color: #111827;\n    font-size: 12px;\n    text-transform: uppercase;\n    letter-spacing: 0.05em;\n    border-bottom: 1px solid #e5e7eb;\n}\n\n.csv-row-select {\n    width: 48px;\n    text-align: center;\n}\n\n.csv-header-row {\n    background: var(--csv-primary-light) !important;\n}\n\n.csv-header-row td {\n    color: var(--csv-primary-dark);\n}\n\n/* Step 3: Mapping */\n.csv-mapping-container {\n    background: white;\n    border: 1px solid #e5e7eb;\n    border-radius: 12px;\n    padding: 24px;\n    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);\n}\n\n.csv-mapping-row {\n    display: flex;\n    align-items: center;\n    padding: 16px 0;\n    border-bottom: 1px solid #f3f4f6;\n}\n\n.csv-mapping-row:last-child {\n    border-bottom: none;\n}\n\n.csv-mapping-label {\n    flex: 1;\n    font-weight: 500;\n    color: #111827;\n}\n\n.csv-required-star {\n    color: #ef4444; /* Red 500 */\n    margin-left: 4px;\n}\n\n.csv-mapping-select {\n    flex: 1;\n}\n\n.csv-select {\n    width: 100%;\n    max-width: 100%;\n    padding: 10px 36px 10px 12px;\n    border: 1px solid var(--csv-border-dark);\n    border-radius: 8px;\n    font-size: 14px;\n    color: var(--csv-text-primary);\n    background-color: white;\n    background-image: url(${p});\n    background-repeat: no-repeat;\n    background-position: right 12px center;\n    background-size: 12px;\n    appearance: none;\n    -webkit-appearance: none;\n    cursor: pointer;\n    transition: border-color 0.2s;\n}\n\n.csv-select:focus {\n    outline: none;\n    border-color: var(--csv-primary);\n}\n\n.csv-field-label-input {\n    padding: 8px 12px;\n    border: 1px solid var(--csv-border-dark);\n    border-radius: 8px;\n    font-size: 14px;\n    width: 100%;\n    max-width: 200px;\n    transition: border-color 0.2s;\n}\n\n.csv-field-label-input:focus {\n    outline: none;\n    border-color: var(--csv-primary);\n}\n\n.csv-field-selector-dropdown {\n    position: relative;\n    display: inline-block;\n}\n\n.csv-field-selector-menu {\n    position: absolute;\n    top: 100%;\n    left: 0;\n    background: white;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n    box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n    min-width: 250px;\n    max-height: 300px;\n    overflow-y: auto;\n    z-index: 10001;\n    margin-top: 4px;\n}\n\n.csv-field-selector-menu.hidden {\n    display: none;\n}\n\n.csv-field-selector-menu.top {\n    top: auto;\n    bottom: 100%;\n    margin-top: 0;\n    margin-bottom: 4px;\n}\n\n.csv-field-checkbox-item {\n    display: flex;\n    align-items: center;\n    padding: 8px 12px;\n    cursor: pointer;\n    transition: background 0.2s;\n}\n\n.csv-field-checkbox-item:hover {\n    background: #f5f5f5;\n}\n\n.csv-field-checkbox-item input[type="checkbox"] {\n    margin-right: 8px;\n    cursor: pointer;\n    width: 16px;\n    height: 16px;\n    accent-color: var(--csv-primary);\n}\n\n.csv-field-checkbox-item span {\n    flex: 1;\n}\n\n.csv-btn-icon {\n    background: none;\n    border: none;\n    color: #ef4444;\n    font-size: 20px;\n    cursor: pointer;\n    padding: 6px;\n    border-radius: 6px;\n    transition: background 0.2s;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.csv-btn-icon:hover {\n    background: #fef2f2;\n    color: #dc2626;\n}\n\n/* Step 4: Validation */\n.csv-validation-table td.error {\n    background: #fef2f2;\n    position: relative;\n}\n\n.csv-cell-content {\n    cursor: text;\n    min-width: 100px;\n    outline: none;\n    padding: 4px 8px;\n    border-radius: 4px;\n}\n\n.csv-cell-content:focus {\n    /* Keep the same background - don't change color on focus */\n}\n\n.csv-error-tooltip {\n    display: none;\n    position: absolute;\n    bottom: calc(100% + 8px);\n    left: 50%;\n    transform: translateX(-50%);\n    background: #1f2937; /* Gray 800 */\n    color: white;\n    padding: 8px 12px;\n    border-radius: 6px;\n    font-size: 12px;\n    white-space: nowrap;\n    max-width: 300px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    z-index: 10000;\n    pointer-events: none;\n    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n}\n\n.csv-error-tooltip::after {\n    content: '';\n    position: absolute;\n    top: 100%;\n    left: 50%;\n    transform: translateX(-50%);\n    border: 6px solid transparent;\n    border-top-color: #1f2937;\n}\n\n.csv-validation-table td.error:hover .csv-error-tooltip {\n    display: block;\n    animation: fadeIn 0.2s ease-out;\n}\n\n@keyframes fadeIn {\n    from { opacity: 0; transform: translate(-50%, 4px); }\n    to { opacity: 1; transform: translate(-50%, 0); }\n}\n\n.csv-remove-row {\n    color: #d1d5db;\n    cursor: pointer;\n    font-weight: 300;\n    text-align: center !important;\n    vertical-align: middle;\n    font-size: 14px;\n    padding: 14px 8px;\n    transition: color 0.2s;\n    width: 1%; /* Forces column to be as narrow as possible */\n    white-space: nowrap;\n}\n\n.csv-remove-row:hover {\n    color: #ef4444;\n}\n\n\n\n/* Pagination */\n.csv-pagination {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-top: 24px;\n    padding: 16px 0;\n    border-top: 1px solid #e5e7eb;\n}\n\n.csv-pagination-info {\n    font-size: 14px;\n    color: #6b7280;\n    font-feature-settings: "tnum";\n}\n\n.csv-pagination-controls {\n    display: flex;\n    gap: 8px;\n    align-items: center;\n}\n\n.csv-pagination-btn {\n    padding: 8px 12px;\n    border: 1px solid #e5e7eb;\n    background: white;\n    border-radius: 8px;\n    font-size: 14px;\n    cursor: pointer;\n    transition: all 0.2s;\n    color: #374151;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.csv-pagination-btn:hover:not(:disabled) {\n    background: var(--csv-bg-main);\n    border-color: var(--csv-primary);\n    color: var(--csv-primary);\n}\n\n.csv-pagination-btn:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n    background: #f3f4f6;\n}\n\n.csv-rows-per-page {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    font-size: 14px;\n    color: #6b7280;\n}\n\n.csv-rows-per-page select {\n    padding: 6px 12px;\n    border: 1px solid #d1d5db;\n    border-radius: 6px;\n    font-size: 14px;\n    cursor: pointer;\n    background: white;\n    color: #374151;\n}\n\n/* Paste Modal */\n.csv-paste-modal-overlay {\n    background: rgba(17, 24, 39, 0.6);\n    backdrop-filter: blur(4px);\n}\n\n.csv-paste-modal {\n    border-radius: 16px;\n    padding: 32px;\n    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);\n}\n\n.csv-paste-textarea {\n    width: 100%;\n    min-height: 240px;\n    padding: 16px;\n    border: 1px solid var(--csv-border-dark);\n    border-radius: 8px;\n    font-family: 'JetBrains Mono', monospace;\n    font-size: 13px;\n    line-height: 1.5;\n    resize: vertical;\n    background: var(--csv-bg-main);\n    color: var(--csv-text-primary);\n}\n\n.csv-paste-textarea:focus {\n    outline: none;\n    border-color: var(--csv-primary);\n}\n\n.csv-delimiter-select {\n    padding: 8px 16px;\n    border: 1px solid var(--csv-border-dark);\n    border-radius: 8px;\n    font-size: 14px;\n    cursor: pointer;\n    background: white;\n}\n\n.csv-delimiter-select:focus {\n    outline: none;\n    border-color: var(--csv-primary);\n}\n\n/* Utilities */\n.hidden { display: none !important; }\n\n.csv-spinner {\n    border: 3px solid var(--csv-border);\n    border-radius: 50%;\n    border-top: 3px solid var(--csv-primary);\n    width: 24px;\n    height: 24px;\n    animation: spin 1s linear infinite;\n}\n\n.csv-loading-spinner {\n    border: 4px solid var(--csv-border);\n    border-radius: 50%;\n    border-top: 4px solid var(--csv-primary);\n    width: 48px;\n    height: 48px;\n    animation: spin 1s linear infinite;\n    margin-bottom: 20px;\n}\n\n@keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n}\n\n/* Progress Bar */\n.csv-progress-container {\n    margin-top: 24px;\n    width: 100%;\n}\n\n.csv-progress-bar-bg {\n    width: 100%;\n    height: 8px;\n    background: #e5e7eb;\n    border-radius: 4px;\n    overflow: hidden;\n}\n\n.csv-progress-bar-fill {\n    height: 100%;\n    background: var(--csv-primary);\n    width: 0%;\n    transition: width 0.2s ease;\n}\n\n.csv-progress-text {\n    margin-top: 8px;\n    font-size: 14px;\n    color: var(--csv-text-secondary);\n    text-align: center;\n}\n\n/* Loading Overlay */\n.csv-loading-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(255, 255, 255, 0.95);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    z-index: 10;\n    border-radius: 12px;\n}\n\n.csv-loading-spinner {\n    width: 48px;\n    height: 48px;\n    border: 4px solid #e5e7eb;\n    border-top-color: var(--csv-primary);\n    border-radius: 50%;\n    animation: spin 0.8s linear infinite;\n}\n\n.csv-loading-text {\n    margin-top: 16px;\n    font-size: 16px;\n    font-weight: 500;\n    color: #111827;\n}\n\n.csv-loading-subtext {\n    margin-top: 8px;\n    font-size: 14px;\n    color: #6b7280;\n}\n\n.csv-progress-bar {\n    background: #e5e7eb;\n    border-radius: 4px;\n    overflow: hidden;\n}\n\n.csv-progress-fill-bar {\n    background: var(--csv-primary);\n    transition: width 0.3s ease;\n}\n\n/* Paste Modal */\n.csv-paste-textarea {\n    width: 100%;\n    min-height: 300px;\n    padding: 12px;\n    border: 1px solid #d1d5db;\n    border-radius: 8px;\n    font-family: 'Courier New', monospace;\n    font-size: 13px;\n    resize: vertical;\n}\n\n.csv-paste-textarea:focus {\n    outline: none;\n    border-color: var(--csv-primary);\n    box-shadow: 0 0 0 3px var(--csv-primary-light);\n}\n\n.csv-delimiter-select {\n    padding: 8px 12px;\n    border: 1px solid #d1d5db;\n    border-radius: 6px;\n    font-size: 14px;\n    background: white;\n}\n\n.csv-paste-data-link {\n    color: var(--csv-primary);\n    font-size: 14px;\n    cursor: pointer;\n    transition: color 0.2s;\n}\n\n.csv-paste-data-link:hover {\n    color: var(--csv-primary-hover);\n    text-decoration: underline;\n}\n\n/* Pagination */\n.csv-pagination {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n}\n\n.csv-pagination button:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n}\n\n.csv-row-index {\n    color: var(--csv-text-secondary);\n    font-size: 12px;\n}\n`,""]);const u=d},417:e=>{e.exports=function(e,n){return n||(n={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),n.hash&&(e+=n.hash),/["'() \t\n]|(%20)/.test(e)||n.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},540:e=>{e.exports=function(e){var n=document.createElement("style");return e.setAttributes(n,e.attributes),e.insert(n,e.options),n}},601:e=>{e.exports=function(e){return e[1]}},659:e=>{var n={};e.exports=function(e,t){var r=function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=e.insertStyleElement(e);return{update:function(t){!function(e,n,t){var r="";t.supports&&(r+="@supports (".concat(t.supports,") {")),t.media&&(r+="@media ".concat(t.media," {"));var o=void 0!==t.layer;o&&(r+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),r+=t.css,o&&(r+="}"),t.media&&(r+="}"),t.supports&&(r+="}");var a=t.sourceMap;a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),n.styleTagTransform(r,e,n.options)}(n,e,t)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)}}}},912:e=>{e.exports="data:image/svg+xml;charset=US-ASCII,%3Csvg%20width%3D%2212%22%20height%3D%228%22%20viewBox%3D%220%200%2012%208%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%3Cpath%20d%3D%22M1%201l5%205%205-5%22%20stroke%3D%22%236b7280%22%20stroke-width%3D%221.5%22%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22/%3E%3C/svg%3E"}},n={};function t(r){var o=n[r];if(void 0!==o)return o.exports;var a=n[r]={id:r,exports:{}};return e[r](a,a.exports,t),a.exports}t.m=e,t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.b="undefined"!=typeof document&&document.baseURI||self.location.href,t.nc=void 0;var r={};function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(){var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function s(t,r,o,a){var s=r&&r.prototype instanceof l?r:l,d=Object.create(s.prototype);return i(d,"_invoke",function(t,r,o){var a,i,s,l=0,d=o||[],p=!1,u={p:0,n:0,v:e,a:v,f:v.bind(e,4),d:function(n,t){return a=n,i=0,s=e,u.n=t,c}};function v(t,r){for(i=t,s=r,n=0;!p&&l&&!o&&n<d.length;n++){var o,a=d[n],v=u.p,f=a[2];t>3?(o=f===r)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=v&&((o=t<2&&v<a[1])?(i=0,u.v=r,u.n=a[1]):v<f&&(o=t<3||a[0]>r||r>f)&&(a[4]=t,a[5]=r,u.n=f,i=0))}if(o||t>1)return c;throw p=!0,r}return function(o,d,f){if(l>1)throw TypeError("Generator is already running");for(p&&1===d&&v(d,f),i=d,s=f;(n=i<2?e:s)||!p;){a||(i?i<3?(i>1&&(u.n=-1),v(i,s)):u.n=s:u.v=s);try{if(l=2,a){if(i||(o="next"),n=a[o]){if(!(n=n.call(a,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,i<2&&(i=0)}else 1===i&&(n=a.return)&&n.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((n=(p=u.n<0)?s:t.call(r,u))!==c)break}catch(n){a=e,i=1,s=n}finally{l=1}}return{value:n,done:p}}}(t,o,a),!0),d}var c={};function l(){}function d(){}function p(){}n=Object.getPrototypeOf;var u=[][r]?n(n([][r]())):(i(n={},r,function(){return this}),n),v=p.prototype=l.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,i(e,o,"GeneratorFunction")),e.prototype=Object.create(v),e}return d.prototype=p,i(v,"constructor",p),i(p,"constructor",d),d.displayName="GeneratorFunction",i(p,o,"GeneratorFunction"),i(v),i(v,o,"Generator"),i(v,r,function(){return this}),i(v,"toString",function(){return"[object Generator]"}),(a=function(){return{w:s,m:f}})()}function i(e,n,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}i=function(e,n,t,r){function a(n,t){i(e,n,function(e){return this._invoke(n,t,e)})}n?o?o(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(a("next",0),a("throw",1),a("return",2))},i(e,n,t,r)}function s(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return c(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?c(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function d(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach(function(n){p(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function p(e,n,t){return(n=f(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function u(e,n,t,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void t(e)}s.done?n(c):Promise.resolve(c).then(r,o)}function v(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function f(e){var n=function(e){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=o(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(n)?n:n+""}t.d(r,{default:()=>ne});var b=function(){return e=function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultOptions={delimiter:",",quoteChar:'"',encoding:"UTF-8"},this.worker=null},n=[{key:"createWorker",value:function(){var e=new Blob(["\nlet cancelled = false;\n\nself.onmessage = (e) => {\n  const message = e.data;\n\n  if (message.type === 'cancel') {\n    cancelled = true;\n    return;\n  }\n\n  if (message.type === 'parse') {\n    cancelled = false;\n    try {\n      const rows = parseCSVChunk(\n        message.text,\n        message.delimiter,\n        message.quoteChar,\n        message.chunkIndex,\n        message.totalChunks\n      );\n\n      if (!cancelled) {\n        self.postMessage({\n          type: 'result',\n          rows,\n          chunkIndex: message.chunkIndex,\n          isComplete: message.chunkIndex === message.totalChunks - 1\n        });\n      }\n    } catch (error) {\n      if (!cancelled) {\n        self.postMessage({\n          type: 'error',\n          error: error.message || 'Unknown error'\n        });\n      }\n    }\n  }\n};\n\nfunction parseCSVChunk(text, delimiter, quoteChar, chunkIndex, totalChunks) {\n  const rows = [];\n  let currentRow = [];\n  let currentField = '';\n  let insideQuote = false;\n\n  text = text.replace(/\\r\\n/g, '\\n').replace(/\\r/g, '\\n');\n\n  for (let i = 0; i < text.length; i++) {\n    if (i % 1000 === 0 && cancelled) {\n      throw new Error('Parsing cancelled');\n    }\n\n    const char = text[i];\n    const nextChar = text[i + 1];\n\n    if (i % 50000 === 0) {\n      const percent = Math.round(\n        ((chunkIndex + i / text.length) / totalChunks) * 100\n      );\n      self.postMessage({\n        type: 'progress',\n        percent,\n        rowsParsed: rows.length,\n        chunkIndex\n      });\n    }\n\n    if (char === quoteChar) {\n      if (insideQuote && nextChar === quoteChar) {\n        currentField += quoteChar;\n        i++;\n      } else {\n        insideQuote = !insideQuote;\n      }\n    } else if (char === delimiter && !insideQuote) {\n      currentRow.push(currentField);\n      currentField = '';\n    } else if (char === '\\n' && !insideQuote) {\n      currentRow.push(currentField);\n      rows.push(currentRow);\n      currentRow = [];\n      currentField = '';\n    } else {\n      currentField += char;\n    }\n  }\n\n  if (currentField || currentRow.length > 0) {\n    currentRow.push(currentField);\n    rows.push(currentRow);\n  }\n\n  if (rows.length > 0 && rows[rows.length - 1].length === 1 && rows[rows.length - 1][0] === '') {\n    rows.pop();\n  }\n\n  return rows;\n}\n        "],{type:"application/javascript"});return new Worker(URL.createObjectURL(e))}},{key:"parse",value:(t=a().m(function e(n){var t,r,o,i,c=this,l=arguments;return a().w(function(e){for(;;)switch(e.n){case 0:if(t=l.length>1&&void 0!==l[1]?l[1]:{},r=l.length>2?l[2]:void 0,o=l.length>3?l[3]:void 0,i=d(d({},this.defaultOptions),t),null==r||!r.aborted){e.n=1;break}throw new DOMException("Parsing was aborted","AbortError");case 1:return this.worker=this.createWorker(),e.a(2,new Promise(function(e,t){var a=[],l=1048576;c.worker.onmessage=function(n){var r=n.data;"progress"===r.type?o&&o({percent:r.percent,rowsParsed:r.rowsParsed}):"result"===r.type?(a.push.apply(a,s(r.rows)),r.isComplete&&(c.cleanup(),e(a))):"error"===r.type&&(c.cleanup(),t(new Error(r.error)))},c.worker.onerror=function(e){c.cleanup(),t(new Error("Worker error: "+e.message))},r&&r.addEventListener("abort",function(){c.worker&&(c.worker.postMessage({type:"cancel"}),c.cleanup(),t(new DOMException("Parsing was aborted","AbortError")))});try{if(n instanceof File){var d=Math.ceil(n.size/l),p=0,u=0,v=function(){if(!(null!=r&&r.aborted||p>=n.size)){var e=n.slice(p,p+l),o=new FileReader;o.onload=function(e){if(null==r||!r.aborted){var n=e.target.result;c.worker.postMessage({type:"parse",text:n,delimiter:i.delimiter||",",quoteChar:i.quoteChar||'"',chunkIndex:u,totalChunks:d}),p+=l,u++,v()}},o.onerror=function(e){c.cleanup(),t(e)},o.readAsText(e,i.encoding)}};v()}else c.worker.postMessage({type:"parse",text:n,delimiter:i.delimiter||",",quoteChar:i.quoteChar||'"',chunkIndex:0,totalChunks:1})}catch(e){c.cleanup(),t(e)}}))}},e,this)}),r=function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(e){u(a,r,o,i,s,"next",e)}function s(e){u(a,r,o,i,s,"throw",e)}i(void 0)})},function(e){return r.apply(this,arguments)})},{key:"cleanup",value:function(){this.worker&&(this.worker.terminate(),this.worker=null)}}],n&&v(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,t,r}();function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function m(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function g(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?m(Object(t),!0).forEach(function(n){y(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function y(e,n,t){return(n=w(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function x(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,w(r.key),r)}}function w(e){var n=function(e){if("object"!=h(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=h(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==h(n)?n:n+""}var k=function(){return e=function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.templateFields=n},(n=[{key:"autoMap",value:function(e){var n={},t=new Set;return this.templateFields.forEach(function(r){var o=r.label.toLowerCase().replace(/[^a-z0-9]/g,""),a=-1,i=0;e.forEach(function(e,n){if(!t.has(n)){var r=e.toLowerCase().replace(/[^a-z0-9]/g,"");r===o?(a=n,i=1):(r.includes(o)||o.includes(r))&&i<.8&&(a=n,i=.8)}}),-1!==a&&(n[r.key]=a,t.add(a))}),n}},{key:"validateRow",value:function(e,n){var t={isValid:!0,errors:{},transformed:{}};return this.templateFields.forEach(function(r){var o=n[r.key],a=void 0!==o&&-1!==o?e[o]:"";if("string"==typeof a&&(a=a.trim()),!r.required||""!==a&&null!=a||(t.isValid=!1,t.errors[r.key]="Required field"),r.validate&&a){var i=r.validate(a);!0!==i&&(t.isValid=!1,t.errors[r.key]="string"==typeof i?i:"Invalid value")}t.transformed[r.key]=a}),t}},{key:"validateAll",value:function(e,n){var t=this,r=e.map(function(e){return t.validateRow(e,n)}),o=this.templateFields.find(function(e){return"email"===e.key||e.label.toLowerCase().includes("email")});if(o){var a=new Map;r.forEach(function(e,n){var t=e.transformed[o.key];if(t&&""!==t.trim()){var i=t.toLowerCase().trim();if(a.has(i)){e.isValid=!1,e.errors[o.key]="Duplicate email";var s=a.get(i);r[s].isValid=!1,r[s].errors[o.key]="Duplicate email"}else a.set(i,n)}})}return r}},{key:"revalidateTransformed",value:function(e){var n=this,t=e.map(function(e){var t={isValid:!0,errors:{},transformed:g({},e.transformed)};return n.templateFields.forEach(function(e){var n=t.transformed[e.key]||"";if(!e.required||""!==n&&null!=n||(t.isValid=!1,t.errors[e.key]="Required field"),e.validate&&n){var r=e.validate(n);!0!==r&&(t.isValid=!1,t.errors[e.key]="string"==typeof r?r:"Invalid value")}}),t}),r=this.templateFields.find(function(e){return"email"===e.key||e.label.toLowerCase().includes("email")});if(r){var o=new Map;t.forEach(function(e,n){var a=e.transformed[r.key];if(a&&""!==a.trim()){var i=a.toLowerCase().trim();if(o.has(i)){e.isValid=!1,e.errors[r.key]="Duplicate email";var s=o.get(i);t[s].isValid=!1,t[s].errors[r.key]="Duplicate email"}else o.set(i,n)}})}return t}}])&&x(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}();function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function P(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function j(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?P(Object(t),!0).forEach(function(n){E(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):P(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function E(e,n,t){return(n=L(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function O(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,L(r.key),r)}}function L(e){var n=function(e){if("object"!=S(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=S(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==S(n)?n:n+""}var C=function(){return e=function e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=document.querySelector(n),this.options=t,this.events={},this.elements={},this.state={viewMode:"upload",isLoading:!1,currentPage:1,rowsPerPage:10,showErrorsOnly:!1}},n=[{key:"on",value:function(e,n){this.events[e]=n}},{key:"emit",value:function(e,n){this.events[e]&&this.events[e](n)}},{key:"render",value:function(){var e=this,n=document.createElement("div");n.className="csv-mapper-overlay",n.innerHTML='\n            <div class="csv-mapper-modal">\n                <div class="csv-mapper-header">\n                    <h2 id="csv-step-title">CSV Upload</h2>\n                    <span class="csv-mapper-close">&times;</span>\n                </div>\n                <div class="csv-mapper-body" id="csv-mapper-body"></div>\n                <div class="csv-mapper-footer" id="csv-mapper-footer">\n                    <div class="csv-footer-left">\n                        <span id="csv-status-text"></span>\n                    </div>\n                    <div class="csv-footer-right" id="csv-footer-buttons"></div>\n                </div>\n            </div>\n        ',document.body.appendChild(n),this.elements.overlay=n,this.elements.body=n.querySelector("#csv-mapper-body"),this.elements.title=n.querySelector("#csv-step-title"),this.elements.footerButtons=n.querySelector("#csv-footer-buttons"),this.elements.closeIcon=n.querySelector(".csv-mapper-close"),this.elements.closeIcon.addEventListener("click",function(){return e.destroy()})}},{key:"destroy",value:function(){this.elements.overlay&&(this.elements.overlay.remove(),this.elements={}),this.emit("close")}},{key:"showError",value:function(e){this.clearError();var n=document.createElement("div");n.className="csv-error-banner",n.id="csv-error-banner",n.textContent=e;var t=this.elements.overlay.querySelector(".csv-mapper-footer");t.parentNode.insertBefore(n,t)}},{key:"clearError",value:function(){var e,n=null===(e=this.elements.overlay)||void 0===e?void 0:e.querySelector("#csv-error-banner");n&&n.remove()}},{key:"showStep",value:function(e,n){switch(this.elements.body.innerHTML="",this.clearError(),this.state.currentPage=1,e){case 1:this.elements.title.textContent="Upload CSV",this.renderUploadStep(),this.renderFooterButtons(e);break;case 2:this.elements.title.textContent="Select Header Row",this.renderHeaderSelectionStep(n),this.renderFooterButtons(e);break;case 3:this.elements.title.textContent="Map Columns",this.renderMappingStep(n),this.renderFooterButtons(e);break;case 4:this.elements.title.textContent="Verify Data",this.renderValidationStep(n),this.renderFooterButtons(e)}}},{key:"renderFooterButtons",value:function(e){var n=this,t=[];e>1&&!this.state.isLoading&&t.push('<button class="csv-btn csv-btn-secondary" id="csv-prev-btn">Prev</button>'),e<4&&e>1&&!this.state.isLoading&&t.push('<button class="csv-btn csv-btn-primary" id="csv-next-btn">Next</button>'),4!==e||this.state.isLoading||t.push('<button class="csv-btn csv-btn-primary" id="csv-next-btn">Submit</button>'),this.state.isLoading&&t.push('<button class="csv-btn csv-btn-danger" id="csv-cancel-btn">Cancel</button>'),t.push('<button class="csv-btn csv-btn-secondary" id="csv-close-btn">Close</button>'),this.elements.footerButtons.innerHTML=t.join("");var r=this.elements.footerButtons.querySelector("#csv-prev-btn"),o=this.elements.footerButtons.querySelector("#csv-next-btn"),a=this.elements.footerButtons.querySelector("#csv-close-btn"),i=this.elements.footerButtons.querySelector("#csv-cancel-btn");r&&r.addEventListener("click",function(){return n.emit("prev")}),o&&o.addEventListener("click",function(){return n.emit("next")}),a&&a.addEventListener("click",function(){return n.destroy()}),i&&i.addEventListener("click",function(){return n.emit("cancel-loading")})}},{key:"renderUploadStep",value:function(){var e=this;if("paste"!==this.state.viewMode){var n=document.createElement("div");n.style.cssText="max-width: 700px; margin: 0 auto; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 300px;",n.innerHTML='\n            <div class="csv-upload-area" id="csv-drop-zone" style="width: 100%; position: relative; opacity: '.concat(this.state.isLoading?"0.6":"1","; pointer-events: ").concat(this.state.isLoading?"none":"auto",';">\n                <div class="csv-upload-text">Drop files here or click to upload</div>\n                <div class="csv-upload-subtext">XLS, XLSX, CSV files are accepted</div>\n                <input type="file" id="csv-file-input" accept=".csv,.xls,.xlsx" style="display:none">\n                ').concat(this.state.isLoading?'\n                    <div class="csv-loading-overlay">\n                        <div class="csv-loading-spinner"></div>\n                        <div class="csv-loading-text">Processing your file...</div>\n                        <div id="csv-progress-display"></div>\n                        <div class="csv-loading-subtext">This may take a moment for large files</div>\n                    </div>\n                ':"",'\n            </div>\n            <div style="margin-top: 16px; text-align: center;">\n                <a href="#" class="csv-paste-data-link" id="csv-paste-trigger" style="text-decoration: none;">\n                    Or click here to copy paste table data\n                </a>\n            </div>\n        '),this.elements.body.appendChild(n);var t=n.querySelector("#csv-drop-zone"),r=n.querySelector("#csv-file-input"),o=n.querySelector("#csv-paste-trigger");this.state.isLoading||(t.addEventListener("click",function(){return r.click()}),t.addEventListener("dragover",function(e){e.preventDefault(),t.classList.add("dragover")}),t.addEventListener("dragleave",function(){return t.classList.remove("dragover")}),t.addEventListener("drop",function(n){n.preventDefault(),t.classList.remove("dragover"),n.dataTransfer.files.length&&e.handleFileSelected(n.dataTransfer.files[0])}),r.addEventListener("change",function(n){n.target.files.length&&e.handleFileSelected(n.target.files[0])}),o.addEventListener("click",function(n){n.preventDefault(),e.state.viewMode="paste",e.showStep(1)}))}else this.renderPasteView()}},{key:"renderPasteView",value:function(){var e=this,n=document.createElement("div");n.style.cssText="max-width: 700px; margin: 0 auto;",n.innerHTML='\n            <p style="margin: 0 0 16px 0; font-size: 14px; color: #666; line-height: 1.5;">\n                Copy existing table data from a spreadsheet (like an Excel workbook or Google Sheet) and paste it in the field below.\n            </p>\n            <textarea class="csv-paste-textarea" id="csv-paste-data" placeholder="" autofocus></textarea>\n            <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 16px;">\n                <div style="display: flex; align-items: center; gap: 8px;">\n                    <label style="font-size: 14px; color: #666;">Select Delimiter</label>\n                    <select class="csv-delimiter-select" id="csv-delimiter">\n                        <option value=",">Comma</option>\n                        <option value="\\t">Tab</option>\n                        <option value=";">Semicolon</option>\n                        <option value="|">Pipe</option>\n                        <option value=" ">Space</option>\n                    </select>\n                </div>\n                <div style="display: flex; gap: 8px;">\n                    <button class="csv-btn csv-btn-secondary" id="csv-paste-cancel">Cancel</button>\n                    <button class="csv-btn csv-btn-primary" id="csv-paste-submit">Import Data</button>\n                </div>\n            </div>\n        ',this.elements.body.appendChild(n);var t=n.querySelector("#csv-paste-data"),r=n.querySelector("#csv-delimiter"),o=n.querySelector("#csv-paste-cancel"),a=n.querySelector("#csv-paste-submit");o.addEventListener("click",function(){e.state.viewMode="upload",e.showStep(1)}),a.addEventListener("click",function(){var n=t.value.trim();n&&(e.emit("data-pasted",{data:n,delimiter:r.value}),e.state.viewMode="upload")})}},{key:"handleFileSelected",value:function(e){this.state.isLoading=!0,this.showStep(1),this.renderFooterButtons(1),this.emit("file-selected",{file:e,onProgress:function(e){var n=document.querySelector("#csv-progress-display");n&&e.percent>0&&(n.innerHTML='\n                        <div class="csv-progress-bar" style="margin-top: 16px; width: 80%; max-width: 300px;">\n                            <div class="csv-progress-fill csv-progress-fill-bar" style="width: '.concat(e.percent,'%; height: 8px;"></div>\n                        </div>\n                        <div class="csv-loading-subtext" style="margin-top: 8px;">\n                            ').concat(e.percent,"% â€¢ ").concat(e.rowsParsed.toLocaleString()," rows\n                        </div>\n                    "))}})}},{key:"setLoading",value:function(e){this.state.isLoading=e}},{key:"renderHeaderSelectionStep",value:function(e){var n=this,t=e.rows,r=e.selectedRowIndex,o=Math.ceil(t.length/10),a=10*(this.state.currentPage-1),i=a+10,s=t.slice(a,i),c=document.createElement("div");if(c.innerHTML='\n            <div class="csv-preview-table-container">\n                <table class="csv-table">\n                    <tbody>\n                        '.concat(s.map(function(e,n){var t=a+n;return'\n                                <tr class="'.concat(t===r?"csv-header-row":"",'">\n                                    <td class="csv-row-select">\n                                        <input type="radio" name="header-row" value="').concat(t,'" ').concat(t===r?"checked":"",'>\n                                    </td>\n                                    <td class="csv-row-index">').concat(t+1,"</td>\n                                    ").concat(e.map(function(e){return"<td>".concat(e,"</td>")}).join(""),"\n                                </tr>\n                            ")}).join(""),"\n                    </tbody>\n                </table>\n            </div>\n            ").concat(o>1?'\n                <div class="csv-pagination" style="display: flex; justify-content: center; align-items: center; gap: 16px; margin-top: 16px;">\n                    <button class="csv-btn csv-btn-secondary" id="csv-page-prev" '.concat(1===this.state.currentPage?"disabled":"",' style="padding: 4px 12px; font-size: 14px;">Previous</button>\n                    <span style="font-size: 14px; color: #666;">Page ').concat(this.state.currentPage," of ").concat(o,'</span>\n                    <button class="csv-btn csv-btn-secondary" id="csv-page-next" ').concat(this.state.currentPage===o?"disabled":"",' style="padding: 4px 12px; font-size: 14px;">Next</button>\n                </div>\n            '):"","\n        "),this.elements.body.appendChild(c),c.querySelectorAll('input[name="header-row"]').forEach(function(e){e.addEventListener("change",function(e){n.emit("header-row-selected",parseInt(e.target.value))})}),o>1){var l=c.querySelector("#csv-page-prev"),d=c.querySelector("#csv-page-next");l&&l.addEventListener("click",function(){n.state.currentPage>1&&(n.state.currentPage--,n.showStep(2,e))}),d&&d.addEventListener("click",function(){n.state.currentPage<o&&(n.state.currentPage++,n.showStep(2,e))})}}},{key:"renderMappingStep",value:function(e){var n=this,t=e.templateFields,r=e.availableFields,o=e.headers,a=e.mapping,i=new Set(t.map(function(e){return e.key})),s=document.createElement("div");s.innerHTML='\n            <div style="margin-bottom: 16px;">\n                <div class="csv-field-selector-dropdown">\n                    <button class="csv-btn csv-btn-secondary" id="csv-field-selector-btn">+ Add/Remove Fields</button>\n                    <div class="csv-field-selector-menu hidden" id="csv-field-selector-menu">\n                        <div style="padding: 8px; border-bottom: 1px solid #eee; font-weight: 600;">Select Fields</div>\n                        '.concat(r.map(function(e){return'\n                            <label class="csv-field-checkbox-item">\n                                <input type="checkbox" value="'.concat(e.key,'" ').concat(i.has(e.key)?"checked":"",">\n                                <span>").concat(e.label,"</span>\n                            </label>\n                        ")}).join(""),'\n                    </div>\n                </div>\n            </div>\n            <div class="csv-mapping-row" style="background: #f5f5f5; font-weight: 600; padding: 12px;">\n                <div class="csv-mapping-label">Template Fields</div>\n                <div class="csv-mapping-select">Columns in your File</div>\n            </div>\n            <div id="csv-mapping-rows">\n                ').concat(t.map(function(e,n){return'\n                    <div class="csv-mapping-row" data-field-index="'.concat(n,'" data-field-key="').concat(e.key,'">\n                        <div class="csv-mapping-label">\n                            ').concat(e.label,'\n                            <span class="csv-required-star">*</span>\n                        </div>\n                        <div class="csv-mapping-select">\n                            <select class="csv-select" data-key="').concat(e.key,'">\n                                <option value="">Select a column</option>\n                                ').concat(o.map(function(n,t){return'\n                                    <option value="'.concat(t,'" ').concat(a[e.key]===t?"selected":"",">\n                                        ").concat(n,"\n                                    </option>\n                                ")}).join(""),"\n                            </select>\n                        </div>\n                    </div>\n                ")}).join(""),"\n            </div>\n        "),this.elements.body.appendChild(s);var c=s.querySelector("#csv-field-selector-btn"),l=s.querySelector("#csv-field-selector-menu");if(console.log("Dropdown elements:",{selectorBtn:c,selectorMenu:l}),c&&l){c.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),console.log("Dropdown button clicked"),l.classList.toggle("hidden")});var d=function(e){l.contains(e.target)||c.contains(e.target)||l.classList.add("hidden")};setTimeout(function(){document.addEventListener("click",d)},100),this.dropdownCleanup=function(){document.removeEventListener("click",d)}}s.querySelectorAll('.csv-field-checkbox-item input[type="checkbox"]').forEach(function(e){e.addEventListener("change",function(e){n.emit("toggle-template-field",{key:e.target.value,enabled:e.target.checked})})}),s.querySelectorAll("select").forEach(function(e){e.addEventListener("change",function(e){n.emit("mapping-changed",{key:e.target.dataset.key,columnIndex:e.target.value?parseInt(e.target.value):-1})})})}},{key:"renderValidationStep",value:function(e){var n,t,r,o=this,a=e.validationResults,i=e.templateFields,s=a.filter(function(e){return!e.isValid}).length;0===s&&this.state.showErrorsOnly&&(this.state.showErrorsOnly=!1);var c=a.map(function(e,n){return j(j({},e),{},{originalIndex:n})}),l=this.state.showErrorsOnly?c.filter(function(e){return!e.isValid}):c,d=l.length,p=Math.ceil(d/this.state.rowsPerPage),u=(this.state.currentPage-1)*this.state.rowsPerPage,v=Math.min(u+this.state.rowsPerPage,d),f=l.slice(u,v),b=document.createElement("div");if(b.innerHTML='\n            <div style="margin-bottom: 16px; display: flex; justify-content: space-between; align-items: center;">\n                <div>\n                    <button class="csv-btn csv-btn-secondary" id="csv-export-json">Export JSON</button>\n                    <button class="csv-btn csv-btn-secondary" id="csv-export-csv" style="margin-left: 8px;">Export CSV</button>\n                </div>\n                <div style="font-size: 14px; color: #666;">\n                    '.concat(s>0?'\n                        <span style="color: #dc2626; font-weight: 500;">\n                            Found '.concat(s," invalid row").concat(1!==s?"s":"",'.\n                            <button id="csv-toggle-errors" style="background: none; border: none; color: #2563eb; text-decoration: underline; cursor: pointer; margin-left: 8px; padding: 0; font: inherit; font-weight: 600;">\n                                ').concat(this.state.showErrorsOnly?"Show all rows":"Show only errors","\n                            </button>\n                        </span>\n                    "):"<span>All rows are valid</span>",'\n                </div>\n            </div>\n            <div class="csv-preview-table-container">\n                <table class="csv-table csv-validation-table">\n                    <thead>\n                        <tr>\n                            <th>#</th>\n                            ').concat(i.map(function(e){return"<th>".concat(e.label,"</th>")}).join(""),"\n                            <th>Remove</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        ").concat(f.map(function(e,n){return"\n                                <tr>\n                                    <td>".concat(u+n+1,"</td>\n                                    ").concat(i.map(function(n){var t=e.transformed[n.key]||"",r=e.errors[n.key];return'\n                                            <td class="'.concat(r?"error":"",'" data-row-index="').concat(e.originalIndex,'" data-field-key="').concat(n.key,'">\n                                                <div class="csv-cell-content" contenteditable="true">').concat(t,"</div>\n                                                ").concat(r?'<div class="csv-error-tooltip">'.concat(r,"</div>"):"","\n                                            </td>\n                                        ")}).join(""),'\n                                    <td class="csv-remove-row" data-index="').concat(e.originalIndex,'">X</td>\n                                </tr>\n                            ')}).join(""),"\n                    </tbody>\n                </table>\n            </div>\n            ").concat(p>1?'\n                <div class="csv-pagination" style="display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; margin-top: 16px; padding: 0 8px; gap: 16px;">\n                    <div class="csv-rows-per-page" style="display: flex; align-items: center; gap: 8px; font-size: 14px; color: #666;">\n                        <span>Rows per page:</span>\n                        <select id="csv-rows-per-page" style="padding: 4px; border-radius: 4px; border: 1px solid #ddd;">\n                            <option value="10" '.concat(10===this.state.rowsPerPage?"selected":"",'>10</option>\n                            <option value="25" ').concat(25===this.state.rowsPerPage?"selected":"",'>25</option>\n                            <option value="50" ').concat(50===this.state.rowsPerPage?"selected":"",'>50</option>\n                            <option value="100" ').concat(100===this.state.rowsPerPage?"selected":"",'>100</option>\n                        </select>\n                    </div>\n                    <div class="csv-pagination-controls" style="display: flex; justify-content: center; align-items: center; gap: 8px;">\n                        <button class="csv-btn csv-btn-secondary" id="csv-page-first" ').concat(1===this.state.currentPage?"disabled":"",' style="padding: 4px 8px; font-size: 14px; min-width: 32px;" title="First Page">&laquo;</button>\n                        <button class="csv-btn csv-btn-secondary" id="csv-page-prev" ').concat(1===this.state.currentPage?"disabled":"",' style="padding: 4px 8px; font-size: 14px; min-width: 32px;" title="Previous Page">&lsaquo;</button>\n                        <div style="display: flex; align-items: center; gap: 4px; font-size: 14px; color: #666;">\n                            <span>Page</span>\n                            <input type="number" id="csv-page-input" min="1" max="').concat(p,'" value="').concat(this.state.currentPage,'" style="width: 60px; padding: 4px; text-align: center; border-radius: 4px; border: 1px solid #ddd;">\n                            <span>of ').concat(p.toLocaleString(),'</span>\n                        </div>\n                        <button class="csv-btn csv-btn-secondary" id="csv-page-next" ').concat(this.state.currentPage===p?"disabled":"",' style="padding: 4px 8px; font-size: 14px; min-width: 32px;" title="Next Page">&rsaquo;</button>\n                        <button class="csv-btn csv-btn-secondary" id="csv-page-last" ').concat(this.state.currentPage===p?"disabled":"",' style="padding: 4px 8px; font-size: 14px; min-width: 32px;" title="Last Page">&raquo;</button>\n                    </div>\n                    <div class="csv-pagination-info" style="font-size: 14px; color: #666; text-align: right; white-space: nowrap;">\n                        ').concat(u+1,"-").concat(v," of ").concat(d," rows\n                    </div>\n                </div>\n            "):"","\n        "),this.elements.body.appendChild(b),null===(n=b.querySelector("#csv-export-json"))||void 0===n||n.addEventListener("click",function(){return o.emit("export-json")}),null===(t=b.querySelector("#csv-export-csv"))||void 0===t||t.addEventListener("click",function(){return o.emit("export-csv")}),null===(r=b.querySelector("#csv-toggle-errors"))||void 0===r||r.addEventListener("click",function(){o.state.showErrorsOnly=!o.state.showErrorsOnly,o.state.currentPage=1,o.showStep(4,e)}),b.querySelectorAll(".csv-cell-content").forEach(function(e){e.addEventListener("blur",function(e){var n=e.target.closest("td"),t=parseInt(n.dataset.rowIndex),r=n.dataset.fieldKey,a=e.target.textContent.trim();o.emit("cell-edited",{rowIndex:t,fieldKey:r,newValue:a})}),e.addEventListener("keydown",function(e){"Enter"===e.key&&(e.preventDefault(),e.target.blur())})}),b.querySelectorAll(".csv-remove-row").forEach(function(e){e.addEventListener("click",function(e){var n=parseInt(e.target.dataset.index);o.emit("remove-row",n)})}),p>1){var h=b.querySelector("#csv-rows-per-page"),m=b.querySelector("#csv-page-input"),g=b.querySelector("#csv-page-first"),y=b.querySelector("#csv-page-prev"),x=b.querySelector("#csv-page-next"),w=b.querySelector("#csv-page-last");null==h||h.addEventListener("change",function(n){o.state.rowsPerPage=parseInt(n.target.value),o.state.currentPage=1,o.showStep(4,e)}),null==m||m.addEventListener("blur",function(n){var t=parseInt(n.target.value);(isNaN(t)||t<1)&&(t=1),t>p&&(t=p),o.state.currentPage=t,o.showStep(4,e)}),null==m||m.addEventListener("keydown",function(e){"Enter"===e.key&&e.target.blur()}),null==g||g.addEventListener("click",function(){o.state.currentPage=1,o.showStep(4,e)}),null==y||y.addEventListener("click",function(){o.state.currentPage>1&&(o.state.currentPage--,o.showStep(4,e))}),null==x||x.addEventListener("click",function(){o.state.currentPage<p&&(o.state.currentPage++,o.showStep(4,e))}),null==w||w.addEventListener("click",function(){o.state.currentPage=p,o.showStep(4,e)})}}},{key:"addMappingRow",value:function(e,n,t){var r=this,o=document.querySelector("#csv-mapping-rows");if(o){var a='\n            <div class="csv-mapping-row" data-field-key="'.concat(e.key,'">\n                <div class="csv-mapping-label">\n                    ').concat(e.label,'\n                    <span class="csv-required-star">*</span>\n                </div>\n                <div class="csv-mapping-select">\n                    <select class="csv-select" data-key="').concat(e.key,'">\n                        <option value="">Select a column</option>\n                        ').concat(n.map(function(n,r){return'\n                            <option value="'.concat(r,'" ').concat(t[e.key]===r?"selected":"",">\n                                ").concat(n,"\n                            </option>\n                        ")}).join(""),"\n                    </select>\n                </div>\n            </div>\n        ");o.insertAdjacentHTML("beforeend",a);var i=o.querySelector('select[data-key="'.concat(e.key,'"]'));i&&i.addEventListener("change",function(e){r.emit("mapping-changed",{key:e.target.dataset.key,columnIndex:e.target.value?parseInt(e.target.value):-1})})}}},{key:"removeMappingRow",value:function(e){var n=document.querySelector('.csv-mapping-row[data-field-key="'.concat(e,'"]'));n&&n.remove()}}],n&&O(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}(),R=t(72),M=t.n(R),q=t(825),I=t.n(q),F=t(659),z=t.n(F),T=t(56),D=t.n(T),A=t(540),V=t.n(A),B=t(113),G=t.n(B),U=t(365),H={};function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function _(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function Q(){var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function a(t,r,o,a){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return X(l,"_invoke",function(t,r,o){var a,s,c,l=0,d=o||[],p=!1,u={p:0,n:0,v:e,a:v,f:v.bind(e,4),d:function(n,t){return a=n,s=0,c=e,u.n=t,i}};function v(t,r){for(s=t,c=r,n=0;!p&&l&&!o&&n<d.length;n++){var o,a=d[n],v=u.p,f=a[2];t>3?(o=f===r)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=v&&((o=t<2&&v<a[1])?(s=0,u.v=r,u.n=a[1]):v<f&&(o=t<3||a[0]>r||r>f)&&(a[4]=t,a[5]=r,u.n=f,s=0))}if(o||t>1)return i;throw p=!0,r}return function(o,d,f){if(l>1)throw TypeError("Generator is already running");for(p&&1===d&&v(d,f),s=d,c=f;(n=s<2?e:c)||!p;){a||(s?s<3?(s>1&&(u.n=-1),v(s,c)):u.n=c:u.v=c);try{if(l=2,a){if(s||(o="next"),n=a[o]){if(!(n=n.call(a,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,s<2&&(s=0)}else 1===s&&(n=a.return)&&n.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=e}else if((n=(p=u.n<0)?c:t.call(r,u))!==i)break}catch(n){a=e,s=1,c=n}finally{l=1}}return{value:n,done:p}}}(t,o,a),!0),l}var i={};function s(){}function c(){}function l(){}n=Object.getPrototypeOf;var d=[][r]?n(n([][r]())):(X(n={},r,function(){return this}),n),p=l.prototype=s.prototype=Object.create(d);function u(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,X(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return c.prototype=l,X(p,"constructor",l),X(l,"constructor",c),c.displayName="GeneratorFunction",X(l,o,"GeneratorFunction"),X(p),X(p,o,"Generator"),X(p,r,function(){return this}),X(p,"toString",function(){return"[object Generator]"}),(Q=function(){return{w:a,m:u}})()}function X(e,n,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}X=function(e,n,t,r){function a(n,t){X(e,n,function(e){return this._invoke(n,t,e)})}n?o?o(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(a("next",0),a("throw",1),a("return",2))},X(e,n,t,r)}function W(e,n,t,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void t(e)}s.done?n(c):Promise.resolve(c).then(r,o)}function J(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var a=e.apply(n,t);function i(e){W(a,r,o,i,s,"next",e)}function s(e){W(a,r,o,i,s,"throw",e)}i(void 0)})}}function K(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function $(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?K(Object(t),!0).forEach(function(n){Y(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):K(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Y(e,n,t){return(n=ee(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function Z(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ee(r.key),r)}}function ee(e){var n=function(e){if("object"!=N(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=N(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==N(n)?n:n+""}H.styleTagTransform=G(),H.setAttributes=D(),H.insert=z().bind(null,"head"),H.domAPI=I(),H.insertStyleElement=V(),M()(U.A,H),U.A&&U.A.locals&&U.A.locals;var ne=function(){return e=function e(n){var t,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),o.availableFields)t=o.columns||[],r=o.availableFields;else{var a=o.columns||[],i=a.filter(function(e){return e.default});t=i.length>0?i:a,r=a}this.options=$({columns:t,availableFields:r},o),this.state={step:1,rawRows:[],headerRowIndex:0,headers:[],mapping:{},data:[],validationResults:[]},this.parser=new b,this.validator=new k(this.options.columns),this.ui=new C(n,this.options),this.bindEvents()},n=[{key:"init",value:function(){this.ui.render(),this.ui.showStep(1)}},{key:"bindEvents",value:function(){var e=this;this.ui.on("close",function(){console.log("Mapper closed")}),this.ui.on("file-selected",function(){var n=J(Q().m(function n(t){var r,o,a,i,s,c;return Q().w(function(n){for(;;)switch(n.p=n.n){case 0:return r=t.file,o=t.onProgress,n.p=1,a=0,i=function(e){var n=Date.now();(n-a>100||100===e.percent)&&(o(e),a=n)},n.n=2,e.parser.parse(r,{},null,i);case 2:s=n.v,e.ui.setLoading(!1),e.state.rawRows=s,e.state.step=2,e.state.headerRowIndex=0,e.updateStep(),n.n=4;break;case 3:n.p=3,c=n.v,e.ui.setLoading(!1),console.error("Parse error",c),"AbortError"!==c.name&&e.ui.showError("Error parsing file. Please check the file format and try again.");case 4:return n.a(2)}},n,null,[[1,3]])}));return function(e){return n.apply(this,arguments)}}()),this.ui.on("data-pasted",function(){var n=J(Q().m(function n(t){var r,o,a,i;return Q().w(function(n){for(;;)switch(n.p=n.n){case 0:return r=t.data,o=t.delimiter,e.ui.setLoading(!0),e.updateStep(),n.p=1,n.n=2,e.parser.parse(r,{delimiter:o},null,null);case 2:a=n.v,e.ui.setLoading(!1),e.state.rawRows=a,e.state.step=2,e.state.headerRowIndex=0,e.updateStep(),n.n=4;break;case 3:n.p=3,i=n.v,e.ui.setLoading(!1),console.error("Parse error",i),"AbortError"!==i.name&&e.ui.showError("Error parsing pasted data. Please check the format and try again.");case 4:return n.a(2)}},n,null,[[1,3]])}));return function(e){return n.apply(this,arguments)}}()),this.ui.on("cancel-loading",function(){e.parser.worker&&e.parser.cleanup(),e.ui.setLoading(!1),e.updateStep()}),this.ui.on("header-row-selected",function(n){e.state.headerRowIndex=n}),this.ui.on("mapping-changed",function(n){var t=n.key,r=n.columnIndex;e.state.mapping[t]=r}),this.ui.on("field-label-changed",function(n){var t=n.key,r=n.newLabel,o=e.options.columns.find(function(e){return e.key===t});o&&""!==r.trim()&&(o.label=r.trim())}),this.ui.on("toggle-template-field",function(n){var t=n.key;if(n.enabled){var r=e.options.availableFields.find(function(e){return e.key===t});r&&!e.options.columns.find(function(e){return e.key===t})&&(e.options.columns.push($($({},r),{},{required:!0})),e.state.mapping[t]=-1,e.validator=new k(e.options.columns),e.ui.addMappingRow(r,e.state.headers,e.state.mapping))}else{var o=e.options.columns.findIndex(function(e){return e.key===t});-1!==o&&(e.options.columns.splice(o,1),delete e.state.mapping[t],e.validator=new k(e.options.columns),e.ui.removeMappingRow(t))}}),this.ui.on("prev",function(){e.state.step>1&&(e.state.step--,e.updateStep())}),this.ui.on("next",function(){if(2===e.state.step)e.state.headers=e.state.rawRows[e.state.headerRowIndex],e.state.mapping=e.validator.autoMap(e.state.headers),e.state.step=3;else if(3===e.state.step){var n=e.options.columns.filter(function(n){return void 0===e.state.mapping[n.key]||-1===e.state.mapping[n.key]||""===e.state.mapping[n.key]});if(n.length>0){var t=n.map(function(e){return e.label}).join(", ");return void e.ui.showError("Please map all fields before continuing. Unmapped fields: ".concat(t))}e.ui.clearError();var r=e.state.rawRows.slice(e.state.headerRowIndex+1);e.state.validationResults=e.validator.validateAll(r,e.state.mapping),e.state.step=4}else if(4===e.state.step){var o=e.state.validationResults.filter(function(e){return!e.isValid});return o.length>0?void e.ui.showError("File has ".concat(o.length," invalid row").concat(o.length>1?"s":"",". Please resolve the errors before uploading.")):(e.ui.clearError(),void e.submit())}e.updateStep()}),this.ui.on("cell-edited",function(n){var t=n.rowIndex,r=n.fieldKey,o=n.newValue;e.state.validationResults[t]&&(e.state.validationResults[t].transformed[r]=o,e.state.validationResults=e.validator.revalidateTransformed(e.state.validationResults),e.updateStep())}),this.ui.on("export-json",function(){var n=e.state.validationResults.map(function(e){return e.transformed}),t=new Blob([JSON.stringify(n,null,2)],{type:"application/json"});e.downloadBlob(t,"export.json")}),this.ui.on("export-csv",function(){var n=e.options.columns.map(function(e){return e.label}),t=e.state.validationResults.map(function(n){return e.options.columns.map(function(e){var t=n.transformed[e.key]||"";return'"'.concat(String(t).replace(/"/g,'""'),'"')}).join(",")}),r=[n.join(",")].concat(function(e){return function(e){if(Array.isArray(e))return _(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return _(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t)).join("\n"),o=new Blob([r],{type:"text/csv"});e.downloadBlob(o,"export.csv")}),this.ui.on("remove-row",function(n){e.state.validationResults.splice(n,1),e.state.validationResults.length>0&&(e.state.validationResults=e.validator.revalidateTransformed(e.state.validationResults)),e.updateStep()})}},{key:"updateStep",value:function(){switch(this.state.step){case 2:this.ui.showStep(2,{rows:this.state.rawRows,selectedRowIndex:this.state.headerRowIndex});break;case 3:this.ui.showStep(3,{templateFields:this.options.columns,availableFields:this.options.availableFields,headers:this.state.headers,mapping:this.state.mapping});break;case 4:this.ui.showStep(4,{validationResults:this.state.validationResults,templateFields:this.options.columns})}}},{key:"submit",value:function(){var e=this.state.validationResults.filter(function(e){return e.isValid}).map(function(e){return e.transformed});console.log("Submitting data",e),this.options.onSubmit&&this.options.onSubmit(e),this.ui.destroy()}},{key:"downloadBlob",value:function(e,n){var t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download=n,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}}],n&&Z(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}();return r.default})());